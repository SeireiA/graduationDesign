{"version":3,"file":"index.js","sources":["store/index.js"],"sourcesContent":["import {createStore} from 'vuex'\nimport {getTokenValue, removeTokenValue} from \"/store/token\";\nimport {getUserInfo, removeUserInfo, setUserInfo} from \"/store/userInfo\";\nimport {getUserSetting, removeUserSetting, setUserSetting} from \"./userSetting\";\nimport {reqGetCurrentUserInfo} from \"@/api/user\";\nimport {reqGetDisguiseStatus} from \"@/api/disguise\";\nimport {getDisguiseStatus, setDisguiseStatus} from \"@/store/disguiseStatus\";\n\nconst store = createStore({\n    state: {\n        userInfo: undefined,\n        userSetting: undefined,\n        disguiseStatus: undefined,\n    },\n    getters: {\n        userInfo: (state) => state.userInfo,\n        userSetting: (state) => state.userSetting,\n        disguiseStatus: (state) => state.disguiseStatus,\n    },\n    mutations: {\n        logout(state) {\n            state.userInfo = undefined\n            removeTokenValue()\n        },\n        setDisguiseStatus(state, info) {\n            state.disguiseStatus = info;\n            setUserSetting(info)\n        },\n        setUserInfo(state, info) {\n            state.userInfo = info;\n            setUserInfo(info)\n        },\n        setUserSetting(state, info) {\n            state.userSetting = info;\n            setUserSetting(info)\n        },\n        initState(state) {\n            let tokenValue = getTokenValue();\n            if (tokenValue) {\n                state.userInfo = getUserInfo();\n                state.usetSetting = getUserSetting();\n                state.disguiseStatus = getDisguiseStatus();\n            }\n        },\n    },\n    actions: {\n        async fetchUserInfo({commit}) {\n            try {\n                const res = await reqGetCurrentUserInfo();\n                commit(\"setUserInfo\", res.data);\n            } catch (error) {\n                uni.showToast({\n                    icon: 'none',\n                    duration: 1500,\n                    title: '获取用户信息失败'\n                });\n            }\n        },\n        async fetchDisguiseStatus({commit}) {\n            try {\n                let {data} = await reqGetDisguiseStatus();\n                commit(\"setDisguiseStatus\", data);\n            }catch (e) {\n                setDisguiseStatus(false)\n            }\n        },\n    },\n})\n\nexport default store\n"],"names":["createStore","removeTokenValue","setUserSetting","setUserInfo","getTokenValue","getUserInfo","getUserSetting","getDisguiseStatus","reqGetCurrentUserInfo","uni","reqGetDisguiseStatus","setDisguiseStatus"],"mappings":";;;;;;;;AAQK,MAAC,QAAQA,cAAAA,YAAY;AAAA,EACtB,OAAO;AAAA,IACH,UAAU;AAAA,IACV,aAAa;AAAA,IACb,gBAAgB;AAAA,EACnB;AAAA,EACD,SAAS;AAAA,IACL,UAAU,CAAC,UAAU,MAAM;AAAA,IAC3B,aAAa,CAAC,UAAU,MAAM;AAAA,IAC9B,gBAAgB,CAAC,UAAU,MAAM;AAAA,EACpC;AAAA,EACD,WAAW;AAAA,IACP,OAAO,OAAO;AACV,YAAM,WAAW;AACjBC,mCAAkB;AAAA,IACrB;AAAA,IACD,kBAAkB,OAAO,MAAM;AAC3B,YAAM,iBAAiB;AACvBC,wBAAAA,eAAe,IAAI;AAAA,IACtB;AAAA,IACD,YAAY,OAAO,MAAM;AACrB,YAAM,WAAW;AACjBC,qBAAAA,YAAY,IAAI;AAAA,IACnB;AAAA,IACD,eAAe,OAAO,MAAM;AACxB,YAAM,cAAc;AACpBD,wBAAAA,eAAe,IAAI;AAAA,IACtB;AAAA,IACD,UAAU,OAAO;AACb,UAAI,aAAaE,YAAAA;AACjB,UAAI,YAAY;AACZ,cAAM,WAAWC,eAAAA;AACjB,cAAM,cAAcC,kBAAAA;AACpB,cAAM,iBAAiBC,qBAAAA;MAC1B;AAAA,IACJ;AAAA,EACJ;AAAA,EACD,SAAS;AAAA,IACL,MAAM,cAAc,EAAC,OAAM,GAAG;AAC1B,UAAI;AACA,cAAM,MAAM,MAAMC,SAAAA;AAClB,eAAO,eAAe,IAAI,IAAI;AAAA,MACjC,SAAQ,OAAO;AACZC,sBAAAA,MAAI,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,OAAO;AAAA,QAC3B,CAAiB;AAAA,MACJ;AAAA,IACJ;AAAA,IACD,MAAM,oBAAoB,EAAC,OAAM,GAAG;AAChC,UAAI;AACA,YAAI,EAAC,KAAI,IAAI,MAAMC,aAAAA;AACnB,eAAO,qBAAqB,IAAI;AAAA,MACnC,SAAO,GAAG;AACPC,6BAAAA,kBAAkB,KAAK;AAAA,MAC1B;AAAA,IACJ;AAAA,EACJ;AACL,CAAC;;"}