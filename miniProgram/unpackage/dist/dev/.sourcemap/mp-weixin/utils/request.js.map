{"version":3,"file":"request.js","sources":["utils/request.js"],"sourcesContent":["import env from '../env';\nimport {getTokenValue} from \"@/store/token\";\nimport store from \"../store\";\n\n\nfunction service(options = {}) {\n    options.url = `${env.baseHttps}${options.url}`;\n    options.timeout = 100000;\n    const tokenValue = getTokenValue();\n    if (tokenValue) {\n        options.header = {\n            'content-type': 'application/json',\n            'Authorization': `Bearer ${tokenValue}`\n        };\n    }\n\n    return new Promise((resolve, reject) => {\n        uni.request({\n            ...options,\n            success: function (res) {\n                if (res.statusCode === 200) {\n                    const response = res.data;\n\n                    if (response.code === 200) {\n                        resolve(response);\n                    }else if (response.code === 401){\n                        store.commit(\"logout\");\n                        uni.reLaunch({\n                            url: '/pages/user/user'\n                        })\n                    }else {\n                        reject(response);\n                    }\n                } else {\n                    reject('与服务器建立连接失败');\n                }\n            },\n            fail: function (e) {\n                console.log(e)\n                reject('请检查您的网络环境是否正常');\n            }\n        });\n    });\n}\n\nexport default service;\n"],"names":["env","getTokenValue","uni","store"],"mappings":";;;;;AAKA,SAAS,QAAQ,UAAU,IAAI;AAC3B,UAAQ,MAAM,GAAGA,IAAG,IAAC,SAAS,GAAG,QAAQ,GAAG;AAC5C,UAAQ,UAAU;AAClB,QAAM,aAAaC,YAAAA;AACnB,MAAI,YAAY;AACZ,YAAQ,SAAS;AAAA,MACb,gBAAgB;AAAA,MAChB,iBAAiB,UAAU,UAAU;AAAA,IACjD;AAAA,EACK;AAED,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpCC,kBAAAA,MAAI,QAAQ;AAAA,MACR,GAAG;AAAA,MACH,SAAS,SAAU,KAAK;AACpB,YAAI,IAAI,eAAe,KAAK;AACxB,gBAAM,WAAW,IAAI;AAErB,cAAI,SAAS,SAAS,KAAK;AACvB,oBAAQ,QAAQ;AAAA,UACxC,WAA8B,SAAS,SAAS,KAAI;AAC5BC,8BAAM,OAAO,QAAQ;AACrBD,0BAAAA,MAAI,SAAS;AAAA,cACT,KAAK;AAAA,YACjC,CAAyB;AAAA,UACzB,OAA0B;AACF,mBAAO,QAAQ;AAAA,UAClB;AAAA,QACrB,OAAuB;AACH,iBAAO,YAAY;AAAA,QACtB;AAAA,MACJ;AAAA,MACD,MAAM,SAAU,GAAG;AACfA,sBAAAA,MAAA,MAAA,OAAA,0BAAY,CAAC;AACb,eAAO,eAAe;AAAA,MACzB;AAAA,IACb,CAAS;AAAA,EACT,CAAK;AACL;;"}