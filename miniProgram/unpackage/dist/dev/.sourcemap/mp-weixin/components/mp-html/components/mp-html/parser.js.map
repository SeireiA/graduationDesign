{"version":3,"file":"parser.js","sources":["components/mp-html/components/mp-html/parser.js"],"sourcesContent":["/**\n * @fileoverview html 解析器\n */\n\n// 配置\nconst config = {\n  // 信任的标签（保持标签名不变）\n  trustTags: makeMap('card,a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,ruby,rt,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video'),\n\n  // 块级标签（转为 div，其他的非信任标签转为 span）\n  blockTags: makeMap('address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section'),\n\n  // #ifdef (MP-WEIXIN || MP-QQ || APP-PLUS || MP-360) && VUE3\n  // 行内标签\n  inlineTags: makeMap('abbr,b,big,code,del,em,i,ins,label,q,small,span,strong,sub,sup'),\n  // #endif\n\n  // 要移除的标签\n  ignoreTags: makeMap('area,base,canvas,embed,frame,head,iframe,input,link,map,meta,param,rp,script,source,style,textarea,title,track,wbr'),\n\n  // 自闭合的标签\n  voidTags: makeMap('card,area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr'),\n\n  // html 实体\n  entities: {\n    lt: '<',\n    gt: '>',\n    quot: '\"',\n    apos: \"'\",\n    ensp: '\\u2002',\n    emsp: '\\u2003',\n    nbsp: '\\xA0',\n    semi: ';',\n    ndash: '–',\n    mdash: '—',\n    middot: '·',\n    lsquo: '‘',\n    rsquo: '’',\n    ldquo: '“',\n    rdquo: '”',\n    bull: '•',\n    hellip: '…',\n    larr: '←',\n    uarr: '↑',\n    rarr: '→',\n    darr: '↓'\n  },\n\n  // 默认的标签样式\n  tagStyle: {\n    // #ifndef APP-PLUS-NVUE\n    address: 'font-style:italic',\n    big: 'display:inline;font-size:1.2em',\n    caption: 'display:table-caption;text-align:center',\n    center: 'text-align:center',\n    cite: 'font-style:italic',\n    dd: 'margin-left:40px',\n    mark: 'background-color:yellow',\n    pre: 'font-family:monospace;white-space:pre',\n    s: 'text-decoration:line-through',\n    small: 'display:inline;font-size:0.8em',\n    strike: 'text-decoration:line-through',\n    u: 'text-decoration:underline'\n    // #endif\n  },\n\n  // svg 大小写对照表\n  svgDict: {\n    animatetransform: 'animateTransform',\n    lineargradient: 'linearGradient',\n    viewbox: 'viewBox',\n    attributename: 'attributeName',\n    repeatcount: 'repeatCount',\n    repeatdur: 'repeatDur',\n    foreignobject: 'foreignObject'\n  }\n}\nconst tagSelector={}\nconst {\n  windowWidth,\n  // #ifdef MP-WEIXIN\n  system\n  // #endif\n} = uni.getSystemInfoSync()\nconst blankChar = makeMap(' ,\\r,\\n,\\t,\\f')\nlet idIndex = 0\n\n// #ifdef H5 || APP-PLUS\nconfig.ignoreTags.iframe = undefined\nconfig.trustTags.iframe = true\nconfig.ignoreTags.embed = undefined\nconfig.trustTags.embed = true\n// #endif\n// #ifdef APP-PLUS-NVUE\nconfig.ignoreTags.source = undefined\nconfig.ignoreTags.style = undefined\n// #endif\n\n/**\n * @description 创建 map\n * @param {String} str 逗号分隔\n */\nfunction makeMap (str) {\n  const map = Object.create(null)\n  const list = str.split(',')\n  for (let i = list.length; i--;) {\n    map[list[i]] = true\n  }\n  return map\n}\n\n/**\n * @description 解码 html 实体\n * @param {String} str 要解码的字符串\n * @param {Boolean} amp 要不要解码 &amp;\n * @returns {String} 解码后的字符串\n */\nfunction decodeEntity (str, amp) {\n  let i = str.indexOf('&')\n  while (i !== -1) {\n    const j = str.indexOf(';', i + 3)\n    let code\n    if (j === -1) break\n    if (str[i + 1] === '#') {\n      // &#123; 形式的实体\n      code = parseInt((str[i + 2] === 'x' ? '0' : '') + str.substring(i + 2, j))\n      if (!isNaN(code)) {\n        str = str.substr(0, i) + String.fromCharCode(code) + str.substr(j + 1)\n      }\n    } else {\n      // &nbsp; 形式的实体\n      code = str.substring(i + 1, j)\n      if (config.entities[code] || (code === 'amp' && amp)) {\n        str = str.substr(0, i) + (config.entities[code] || '&') + str.substr(j + 1)\n      }\n    }\n    i = str.indexOf('&', i + 1)\n  }\n  return str\n}\n\n/**\n * @description 合并多个块级标签，加快长内容渲染\n * @param {Array} nodes 要合并的标签数组\n */\nfunction mergeNodes (nodes) {\n  let i = nodes.length - 1\n  for (let j = i; j >= -1; j--) {\n    if (j === -1 || nodes[j].c || !nodes[j].name || (nodes[j].name !== 'div' && nodes[j].name !== 'p' && nodes[j].name[0] !== 'h') || (nodes[j].attrs.style || '').includes('inline')) {\n      if (i - j >= 5) {\n        nodes.splice(j + 1, i - j, {\n          name: 'div',\n          attrs: {},\n          children: nodes.slice(j + 1, i + 1)\n        })\n      }\n      i = j - 1\n    }\n  }\n}\n\n/**\n * @description html 解析器\n * @param {Object} vm 组件实例\n */\nfunction Parser (vm) {\n  this.options = vm || {}\n  this.tagStyle = Object.assign({}, config.tagStyle, this.options.tagStyle)\n  this.imgList = vm.imgList || []\n  this.imgList._unloadimgs = 0\n  this.plugins = vm.plugins || []\n  this.attrs = Object.create(null)\n  this.stack = []\n  this.nodes = []\n  this.pre = (this.options.containerStyle || '').includes('white-space') && this.options.containerStyle.includes('pre') ? 2 : 0\n}\n\n/**\n * @description 执行解析\n * @param {String} content 要解析的文本\n */\nParser.prototype.parse = function (content) {\n  // 插件处理\n  for (let i = this.plugins.length; i--;) {\n    if (this.plugins[i].onUpdate) {\n      content = this.plugins[i].onUpdate(content, config) || content\n    }\n  }\n\n  new Lexer(this).parse(content)\n  // 出栈未闭合的标签\n  while (this.stack.length) {\n    this.popNode()\n  }\n  if (this.nodes.length > 50) {\n    mergeNodes(this.nodes)\n  }\n  return this.nodes\n}\n\n/**\n * @description 将标签暴露出来（不被 rich-text 包含）\n */\nParser.prototype.expose = function () {\n  // #ifndef APP-PLUS-NVUE\n  for (let i = this.stack.length; i--;) {\n    const item = this.stack[i]\n    if (item.c || item.name === 'a' || item.name === 'video' || item.name === 'audio') return\n    item.c = 1\n  }\n  // #endif\n}\n\n/**\n * @description 处理插件\n * @param {Object} node 要处理的标签\n * @returns {Boolean} 是否要移除此标签\n */\nParser.prototype.hook = function (node) {\n  for (let i = this.plugins.length; i--;) {\n    if (this.plugins[i].onParse && this.plugins[i].onParse(node, this) === false) {\n      return false\n    }\n  }\n  return true\n}\n\n/**\n * @description 将链接拼接上主域名\n * @param {String} url 需要拼接的链接\n * @returns {String} 拼接后的链接\n */\nParser.prototype.getUrl = function (url) {\n  const domain = this.options.domain\n  if (url[0] === '/') {\n    if (url[1] === '/') {\n      // // 开头的补充协议名\n      url = (domain ? domain.split('://')[0] : 'http') + ':' + url\n    } else if (domain) {\n      // 否则补充整个域名\n      url = domain + url\n    } /* #ifdef APP-PLUS */ else {\n      url = plus.io.convertLocalFileSystemURL(url)\n    } /* #endif */\n  } else if (!url.includes('data:') && !url.includes('://')) {\n    if (domain) {\n      url = domain + '/' + url\n    } /* #ifdef APP-PLUS */ else {\n      url = plus.io.convertLocalFileSystemURL(url)\n    } /* #endif */\n  }\n  return url\n}\n\n/**\n * @description 解析样式表\n * @param {Object} node 标签\n * @returns {Object}\n */\nParser.prototype.parseStyle = function (node) {\n  const attrs = node.attrs\n  const list = (this.tagStyle[node.name] || '').split(';').concat((attrs.style || '').split(';'))\n  const styleObj = {}\n  let tmp = ''\n\n  if (attrs.id && !this.xml) {\n    // 暴露锚点\n    if (this.options.useAnchor) {\n      this.expose()\n    } else if (node.name !== 'img' && node.name !== 'a' && node.name !== 'video' && node.name !== 'audio') {\n      attrs.id = undefined\n    }\n  }\n\n  // 转换 width 和 height 属性\n  if (attrs.width) {\n    styleObj.width = parseFloat(attrs.width) + (attrs.width.includes('%') ? '%' : 'px')\n    attrs.width = undefined\n  }\n  if (attrs.height) {\n    styleObj.height = parseFloat(attrs.height) + (attrs.height.includes('%') ? '%' : 'px')\n    attrs.height = undefined\n  }\n\n  for (let i = 0, len = list.length; i < len; i++) {\n    const info = list[i].split(':')\n    if (info.length < 2) continue\n    const key = info.shift().trim().toLowerCase()\n    let value = info.join(':').trim()\n    if ((value[0] === '-' && value.lastIndexOf('-') > 0) || value.includes('safe')) {\n      // 兼容性的 css 不压缩\n      tmp += `;${key}:${value}`\n    } else if (!styleObj[key] || value.includes('import') || !styleObj[key].includes('import')) {\n      // 重复的样式进行覆盖\n      if (value.includes('url')) {\n        // 填充链接\n        let j = value.indexOf('(') + 1\n        if (j) {\n          while (value[j] === '\"' || value[j] === \"'\" || blankChar[value[j]]) {\n            j++\n          }\n          value = value.substr(0, j) + this.getUrl(value.substr(j))\n        }\n      } else if (value.includes('rpx')) {\n        // 转换 rpx（rich-text 内部不支持 rpx）\n        value = value.replace(/[0-9.]+\\s*rpx/g, $ => parseFloat($) * windowWidth / 750 + 'px')\n      }\n      styleObj[key] = value\n    }\n  }\n\n  node.attrs.style = tmp\n  return styleObj\n}\n\n/**\n * @description 解析到标签名\n * @param {String} name 标签名\n * @private\n */\nParser.prototype.onTagName = function (name) {\n  this.tagName = this.xml ? name : name.toLowerCase()\n  if (this.tagName === 'svg') {\n    this.xml = (this.xml || 0) + 1 // svg 标签内大小写敏感\n    config.ignoreTags.style = undefined // svg 标签内 style 可用\n  }\n}\n\n/**\n * @description 解析到属性名\n * @param {String} name 属性名\n * @private\n */\nParser.prototype.onAttrName = function (name) {\n  name = this.xml ? name : name.toLowerCase()\n  if (name.substr(0, 5) === 'data-') {\n    if (name === 'data-src' && !this.attrs.src) {\n      // data-src 自动转为 src\n      this.attrName = 'src'\n    } else if (this.tagName === 'img' || this.tagName === 'a') {\n      // a 和 img 标签保留 data- 的属性，可以在 imgtap 和 linktap 事件中使用\n      this.attrName = name\n    } else {\n      // 剩余的移除以减小大小\n      this.attrName = undefined\n    }\n  } else {\n    this.attrName = name\n    this.attrs[name] = 'T' // boolean 型属性缺省设置\n  }\n}\n\n/**\n * @description 解析到属性值\n * @param {String} val 属性值\n * @private\n */\nParser.prototype.onAttrVal = function (val) {\n  const name = this.attrName || ''\n  if (name === 'style' || name === 'href') {\n    // 部分属性进行实体解码\n    this.attrs[name] = decodeEntity(val, true)\n  } else if (name.includes('src')) {\n    // 拼接主域名\n    this.attrs[name] = this.getUrl(decodeEntity(val, true))\n  } else if (name) {\n    this.attrs[name] = val\n  }\n}\n\n/**\n * @description 解析到标签开始\n * @param {Boolean} selfClose 是否有自闭合标识 />\n * @private\n */\nParser.prototype.onOpenTag = function (selfClose) {\n  // 拼装 node\n  const node = Object.create(null)\n  node.name = this.tagName\n  node.attrs = this.attrs\n  // 避免因为自动 diff 使得 type 被设置为 null 导致部分内容不显示\n  if (this.options.nodes.length) {\n    node.type = 'node'\n  }\n  this.attrs = Object.create(null)\n\n  const attrs = node.attrs\n  const parent = this.stack[this.stack.length - 1]\n  const siblings = parent ? parent.children : this.nodes\n  const close = this.xml ? selfClose : config.voidTags[node.name]\n\n  // 替换标签名选择器\n  if (tagSelector[node.name]) {\n    attrs.class = tagSelector[node.name] + (attrs.class ? ' ' + attrs.class : '')\n  }\n\n  // 转换 embed 标签\n  if (node.name === 'embed') {\n    // #ifndef H5 || APP-PLUS\n    const src = attrs.src || ''\n    // 按照后缀名和 type 将 embed 转为 video 或 audio\n    if (src.includes('.mp4') || src.includes('.3gp') || src.includes('.m3u8') || (attrs.type || '').includes('video')) {\n      node.name = 'video'\n    } else if (src.includes('.mp3') || src.includes('.wav') || src.includes('.aac') || src.includes('.m4a') || (attrs.type || '').includes('audio')) {\n      node.name = 'audio'\n    }\n    if (attrs.autostart) {\n      attrs.autoplay = 'T'\n    }\n    attrs.controls = 'T'\n    // #endif\n    // #ifdef H5 || APP-PLUS\n    this.expose()\n    // #endif\n  }\n\n  // #ifndef APP-PLUS-NVUE\n  // 处理音视频\n  if (node.name === 'video' || node.name === 'audio') {\n    // 设置 id 以便获取 context\n    if (node.name === 'video' && !attrs.id) {\n      attrs.id = 'v' + idIndex++\n    }\n    // 没有设置 controls 也没有设置 autoplay 的自动设置 controls\n    if (!attrs.controls && !attrs.autoplay) {\n      attrs.controls = 'T'\n    }\n    // 用数组存储所有可用的 source\n    node.src = []\n    if (attrs.src) {\n      node.src.push(attrs.src)\n      attrs.src = undefined\n    }\n    this.expose()\n  }\n  // #endif\n\n  // 处理自闭合标签\n  if (close) {\n    if (!this.hook(node) || config.ignoreTags[node.name]) {\n      // 通过 base 标签设置主域名\n      if (node.name === 'base' && !this.options.domain) {\n        this.options.domain = attrs.href\n      } /* #ifndef APP-PLUS-NVUE */ else if (node.name === 'source' && parent && (parent.name === 'video' || parent.name === 'audio') && attrs.src) {\n        // 设置 source 标签（仅父节点为 video 或 audio 时有效）\n        parent.src.push(attrs.src)\n      } /* #endif */\n      return\n    }\n\n    // 解析 style\n    const styleObj = this.parseStyle(node)\n\n    // 处理图片\n    if (node.name === 'img') {\n      if (attrs.src) {\n        // 标记 webp\n        if (attrs.src.includes('webp')) {\n          node.webp = 'T'\n        }\n        // data url 图片如果没有设置 original-src 默认为不可预览的小图片\n        if (attrs.src.includes('data:') && !attrs['original-src']) {\n          attrs.ignore = 'T'\n        }\n        if (!attrs.ignore || node.webp || attrs.src.includes('cloud://')) {\n          for (let i = this.stack.length; i--;) {\n            const item = this.stack[i]\n            if (item.name === 'a') {\n              node.a = item.attrs\n            }\n            if (item.name === 'table' && !node.webp && !attrs.src.includes('cloud://')) {\n              if (!styleObj.display || styleObj.display.includes('inline')) {\n                node.t = 'inline-block'\n              } else {\n                node.t = styleObj.display\n              }\n              styleObj.display = undefined\n            }\n            // #ifndef H5 || APP-PLUS\n            const style = item.attrs.style || ''\n            if (style.includes('flex:') && !style.includes('flex:0') && !style.includes('flex: 0') && (!styleObj.width || parseInt(styleObj.width) > 100)) {\n              styleObj.width = '100% !important'\n              styleObj.height = ''\n              for (let j = i + 1; j < this.stack.length; j++) {\n                this.stack[j].attrs.style = (this.stack[j].attrs.style || '').replace('inline-', '')\n              }\n            } else if (style.includes('flex') && styleObj.width === '100%') {\n              for (let j = i + 1; j < this.stack.length; j++) {\n                const style = this.stack[j].attrs.style || ''\n                if (!style.includes(';width') && !style.includes(' width') && style.indexOf('width') !== 0) {\n                  styleObj.width = ''\n                  break\n                }\n              }\n            } else if (style.includes('inline-block')) {\n              if (styleObj.width && styleObj.width[styleObj.width.length - 1] === '%') {\n                item.attrs.style += ';max-width:' + styleObj.width\n                styleObj.width = ''\n              } else {\n                item.attrs.style += ';max-width:100%'\n              }\n            }\n            // #endif\n            item.c = 1\n          }\n          attrs.i = this.imgList.length.toString()\n          let src = attrs['original-src'] || attrs.src\n          // #ifndef H5 || MP-ALIPAY || APP-PLUS || MP-360\n          if (this.imgList.includes(src)) {\n            // 如果有重复的链接则对域名进行随机大小写变换避免预览时错位\n            let i = src.indexOf('://')\n            if (i !== -1) {\n              i += 3\n              let newSrc = src.substr(0, i)\n              for (; i < src.length; i++) {\n                if (src[i] === '/') break\n                newSrc += Math.random() > 0.5 ? src[i].toUpperCase() : src[i]\n              }\n              newSrc += src.substr(i)\n              src = newSrc\n            }\n          }\n          // #endif\n          this.imgList.push(src)\n          if (!node.t) {\n            this.imgList._unloadimgs += 1\n          }\n          // #ifdef H5 || APP-PLUS\n          if (this.options.lazyLoad) {\n            attrs['data-src'] = attrs.src\n            attrs.src = undefined\n          }\n          // #endif\n        }\n      }\n      if (styleObj.display === 'inline') {\n        styleObj.display = ''\n      }\n      // #ifndef APP-PLUS-NVUE\n      if (attrs.ignore) {\n        styleObj['max-width'] = styleObj['max-width'] || '100%'\n        attrs.style += ';-webkit-touch-callout:none'\n      }\n      // #endif\n      // 设置的宽度超出屏幕，为避免变形，高度转为自动\n      if (parseInt(styleObj.width) > windowWidth) {\n        styleObj.height = undefined\n      }\n      // 记录是否设置了宽高\n      if (!isNaN(parseInt(styleObj.width))) {\n        node.w = 'T'\n      }\n      if (!isNaN(parseInt(styleObj.height)) && (!styleObj.height.includes('%') || (parent && (parent.attrs.style || '').includes('height')))) {\n        node.h = 'T'\n      }\n      if (node.w && node.h && styleObj['object-fit']) {\n        if (styleObj['object-fit'] === 'contain') {\n          node.m = 'aspectFit'\n        } else if (styleObj['object-fit'] === 'cover') {\n          node.m = 'aspectFill'\n        }\n      }\n    } else if (node.name === 'svg') {\n      siblings.push(node)\n      this.stack.push(node)\n      this.popNode()\n      return\n    }\n    for (const key in styleObj) {\n      if (styleObj[key]) {\n        attrs.style += `;${key}:${styleObj[key].replace(' !important', '')}`\n      }\n    }\n    attrs.style = attrs.style.substr(1) || undefined\n    // #ifdef (MP-WEIXIN || MP-QQ) && VUE3\n    if (!attrs.style) {\n      delete attrs.style\n    }\n    // #endif\n  } else {\n    if ((node.name === 'pre' || ((attrs.style || '').includes('white-space') && attrs.style.includes('pre'))) && this.pre !== 2) {\n      this.pre = node.pre = 1\n    }\n    node.children = []\n    this.stack.push(node)\n  }\n\n  // 加入节点树\n  siblings.push(node)\n}\n\n/**\n * @description 解析到标签结束\n * @param {String} name 标签名\n * @private\n */\nParser.prototype.onCloseTag = function (name) {\n  // 依次出栈到匹配为止\n  name = this.xml ? name : name.toLowerCase()\n  let i\n  for (i = this.stack.length; i--;) {\n    if (this.stack[i].name === name) break\n  }\n  if (i !== -1) {\n    while (this.stack.length > i) {\n      this.popNode()\n    }\n  } else if (name === 'p' || name === 'br') {\n    const siblings = this.stack.length ? this.stack[this.stack.length - 1].children : this.nodes\n    siblings.push({\n      name,\n      attrs: {\n        class: tagSelector[name] || '',\n        style: this.tagStyle[name] || ''\n      }\n    })\n  }\n}\n\n/**\n * @description 处理标签出栈\n * @private\n */\nParser.prototype.popNode = function () {\n  const editable = this.options.editable\n  const node = this.stack.pop()\n  let attrs = node.attrs\n  const children = node.children\n  const parent = this.stack[this.stack.length - 1]\n  const siblings = parent ? parent.children : this.nodes\n\n  if (!this.hook(node) || config.ignoreTags[node.name]) {\n    // 获取标题\n    if (node.name === 'title' && children.length && children[0].type === 'text' && this.options.setTitle) {\n      uni.setNavigationBarTitle({\n        title: children[0].text\n      })\n    }\n    siblings.pop()\n    return\n  }\n\n  if (node.pre && this.pre !== 2) {\n    // 是否合并空白符标识\n    this.pre = node.pre = undefined\n    for (let i = this.stack.length; i--;) {\n      if (this.stack[i].pre) {\n        this.pre = 1\n      }\n    }\n  }\n\n  const styleObj = {}\n\n  // 转换 svg\n  if (node.name === 'svg') {\n    if (this.xml > 1) {\n      // 多层 svg 嵌套\n      this.xml--\n      return\n    }\n    // #ifdef APP-PLUS-NVUE\n    (function traversal (node) {\n      if (node.name) {\n        // 调整 svg 的大小写\n        node.name = config.svgDict[node.name] || node.name\n        for (const item in node.attrs) {\n          if (config.svgDict[item]) {\n            node.attrs[config.svgDict[item]] = node.attrs[item]\n            node.attrs[item] = undefined\n          }\n        }\n        for (let i = 0; i < (node.children || []).length; i++) {\n          traversal(node.children[i])\n        }\n      }\n    })(node)\n    // #endif\n    // #ifndef APP-PLUS-NVUE\n    let src = ''\n    const style = attrs.style\n    attrs.style = ''\n    attrs.xmlns = 'http://www.w3.org/2000/svg';\n    (function traversal (node) {\n      if (node.type === 'text') {\n        src += node.text\n        return\n      }\n      const name = config.svgDict[node.name] || node.name\n      if (name === 'foreignObject') {\n        for (const child of (node.children || [])) {\n          if (child.attrs && !child.attrs.xmlns) {\n            child.attrs.xmlns = 'http://www.w3.org/1999/xhtml'\n            break\n          }\n        }\n      }\n      src += '<' + name\n      for (const item in node.attrs) {\n        const val = node.attrs[item]\n        if (val) {\n          src += ` ${config.svgDict[item] || item}=\"${val}\"`\n        }\n      }\n      if (!node.children) {\n        src += '/>'\n      } else {\n        src += '>'\n        for (let i = 0; i < node.children.length; i++) {\n          traversal(node.children[i])\n        }\n        src += '</' + name + '>'\n      }\n    })(node)\n    node.name = 'img'\n    node.attrs = {\n      src: 'data:image/svg+xml;utf8,' + src.replace(/#/g, '%23'),\n      style,\n      ignore: 'T'\n    }\n    node.children = undefined\n    // #endif\n    this.xml = false\n    config.ignoreTags.style = true\n    return\n  }\n\n  // #ifndef APP-PLUS-NVUE\n  // 转换 align 属性\n  if (attrs.align) {\n    if (node.name === 'table') {\n      if (attrs.align === 'center') {\n        styleObj['margin-inline-start'] = styleObj['margin-inline-end'] = 'auto'\n      } else {\n        styleObj.float = attrs.align\n      }\n    } else {\n      styleObj['text-align'] = attrs.align\n    }\n    attrs.align = undefined\n  }\n\n  // 转换 dir 属性\n  if (attrs.dir) {\n    styleObj.direction = attrs.dir\n    attrs.dir = undefined\n  }\n\n  // 转换 font 标签的属性\n  if (node.name === 'font') {\n    if (attrs.color) {\n      styleObj.color = attrs.color\n      attrs.color = undefined\n    }\n    if (attrs.face) {\n      styleObj['font-family'] = attrs.face\n      attrs.face = undefined\n    }\n    if (attrs.size) {\n      let size = parseInt(attrs.size)\n      if (!isNaN(size)) {\n        if (size < 1) {\n          size = 1\n        } else if (size > 7) {\n          size = 7\n        }\n        styleObj['font-size'] = ['x-small', 'small', 'medium', 'large', 'x-large', 'xx-large', 'xxx-large'][size - 1]\n      }\n      attrs.size = undefined\n    }\n  }\n  // #endif\n\n  // 一些编辑器的自带 class\n  if ((attrs.class || '').includes('align-center')) {\n    styleObj['text-align'] = 'center'\n  }\n\n  Object.assign(styleObj, this.parseStyle(node))\n\n  if (node.name !== 'table' && parseInt(styleObj.width) > windowWidth) {\n    styleObj['max-width'] = '100%'\n    styleObj['box-sizing'] = 'border-box'\n  }\n\n  // #ifndef APP-PLUS-NVUE\n  if (config.blockTags[node.name]) {\n    if (!editable) {\n      node.name = 'div'\n    }\n  } else if (!config.trustTags[node.name] && !this.xml) {\n    // 未知标签转为 span，避免无法显示\n    node.name = 'span'\n  }\n\n  if (node.name === 'a' || node.name === 'ad'\n    // #ifdef H5 || APP-PLUS\n    || node.name === 'iframe' // eslint-disable-line\n    // #endif\n  ) {\n    this.expose()\n  } else if (node.name === 'video') {\n    if ((styleObj.height || '').includes('auto')) {\n      styleObj.height = undefined\n    }\n    /* #ifdef APP-PLUS */\n    let str = '<video style=\"width:100%;height:100%\"'\n    if (editable) {\n      attrs.controls = ''\n    }\n    for (const item in attrs) {\n      if (attrs[item]) {\n        str += ' ' + item + '=\"' + attrs[item] + '\"'\n      }\n    }\n    if (this.options.pauseVideo) {\n      str += ' onplay=\"this.dispatchEvent(new CustomEvent(\\'vplay\\',{bubbles:!0}));for(var e=document.getElementsByTagName(\\'video\\'),t=0;t<e.length;t++)e[t]!=this&&e[t].pause()\"'\n    }\n    str += '>'\n    for (let i = 0; i < node.src.length; i++) {\n      str += '<source src=\"' + node.src[i] + '\">'\n    }\n    str += '</video>'\n    node.html = str\n    /* #endif */\n  } else if ((node.name === 'ul' || node.name === 'ol') && (node.c || editable)) {\n    // 列表处理\n    const types = {\n      a: 'lower-alpha',\n      A: 'upper-alpha',\n      i: 'lower-roman',\n      I: 'upper-roman'\n    }\n    if (types[attrs.type]) {\n      attrs.style += ';list-style-type:' + types[attrs.type]\n      attrs.type = undefined\n    }\n    for (let i = children.length; i--;) {\n      if (children[i].name === 'li') {\n        children[i].c = 1\n      }\n    }\n  } else if (node.name === 'table') {\n    // 表格处理\n    // cellpadding、cellspacing、border 这几个常用表格属性需要通过转换实现\n    let padding = parseFloat(attrs.cellpadding)\n    let spacing = parseFloat(attrs.cellspacing)\n    const border = parseFloat(attrs.border)\n    const bordercolor = styleObj['border-color']\n    const borderstyle = styleObj['border-style']\n    if ((node.c || editable)) {\n      // padding 和 spacing 默认 2\n      if (isNaN(padding)) {\n        padding = 2\n      }\n      if (isNaN(spacing)) {\n        spacing = 2\n      }\n    }\n    if (border) {\n      attrs.style += `;border:${border}px ${borderstyle || 'solid'} ${bordercolor || 'gray'}`\n    }\n    if (node.flag && (node.c || editable)) {\n      // 有 colspan 或 rowspan 且含有链接的表格通过 grid 布局实现\n      styleObj.display = 'grid'\n      if (styleObj['border-collapse'] === 'collapse') {\n        styleObj['border-collapse'] = undefined\n        spacing = 0\n      }\n      if (spacing) {\n        styleObj['grid-gap'] = spacing + 'px'\n        styleObj.padding = spacing + 'px'\n      } else if (border) {\n        // 无间隔的情况下避免边框重叠\n        attrs.style += ';border-left:0;border-top:0'\n      }\n\n      const width = [] // 表格的列宽\n      const trList = [] // tr 列表\n      const cells = [] // 保存新的单元格\n      const map = {}; // 被合并单元格占用的格子\n\n      (function traversal (nodes) {\n        for (let i = 0; i < nodes.length; i++) {\n          if (nodes[i].name === 'tr') {\n            trList.push(nodes[i])\n          } else if (nodes[i].name === 'colgroup') {\n            let colI = 1\n            for (const col of (nodes[i].children || [])) {\n              if (col.name === 'col') {\n                const style = col.attrs.style || ''\n                const start = style.indexOf('width') ? style.indexOf(';width') : 0\n                // 提取出宽度\n                if (start !== -1) {\n                  let end = style.indexOf(';', start + 6)\n                  if (end === -1) {\n                    end = style.length\n                  }\n                  width[colI] = style.substring(start ? start + 7 : 6, end)\n                }\n                colI += 1\n              }\n            }\n          } else {\n            traversal(nodes[i].children || [])\n          }\n        }\n      })(children)\n\n      for (let row = 1; row <= trList.length; row++) {\n        let col = 1\n        for (let j = 0; j < trList[row - 1].children.length; j++) {\n          const td = trList[row - 1].children[j]\n          if (td.name === 'td' || td.name === 'th') {\n            // 这个格子被上面的单元格占用，则列号++\n            while (map[row + '.' + col]) {\n            col++\n          }\n          if (editable) {\n            td.r = row\n          }\n            let style = td.attrs.style || ''\n            let start = style.indexOf('width') ? style.indexOf(';width') : 0\n            // 提取出 td 的宽度\n            if (start !== -1) {\n              let end = style.indexOf(';', start + 6)\n              if (end === -1) {\n                end = style.length\n              }\n              if (!td.attrs.colspan) {\n                width[col] = style.substring(start ? start + 7 : 6, end)\n              }\n              style = style.substr(0, start) + style.substr(end)\n            }\n            // 设置竖直对齐\n            style += ';display:flex'\n            start = style.indexOf('vertical-align')\n            if (start !== -1) {\n              const val = style.substr(start + 15, 10)\n              if (val.includes('middle')) {\n                style += ';align-items:center'\n              } else if (val.includes('bottom')) {\n                style += ';align-items:flex-end'\n              }\n            } else {\n              style += ';align-items:center'\n            }\n            // 设置水平对齐\n            start = style.indexOf('text-align')\n            if (start !== -1) {\n              const val = style.substr(start + 11, 10)\n              if (val.includes('center')) {\n                style += ';justify-content: center'\n              } else if (val.includes('right')) {\n                style += ';justify-content: right'\n              }\n            }\n            style = (border ? `;border:${border}px ${borderstyle || 'solid'} ${bordercolor || 'gray'}` + (spacing ? '' : ';border-right:0;border-bottom:0') : '') + (padding ? `;padding:${padding}px` : '') + ';' + style\n            // 处理列合并\n            if (td.attrs.colspan) {\n              style += `;grid-column-start:${col};grid-column-end:${col + parseInt(td.attrs.colspan)}`\n              if (!td.attrs.rowspan) {\n                style += `;grid-row-start:${row};grid-row-end:${row + 1}`\n              }\n              col += parseInt(td.attrs.colspan) - 1\n            }\n            // 处理行合并\n            if (td.attrs.rowspan) {\n              style += `;grid-row-start:${row};grid-row-end:${row + parseInt(td.attrs.rowspan)}`\n              if (!td.attrs.colspan) {\n                style += `;grid-column-start:${col};grid-column-end:${col + 1}`\n              }\n              // 记录下方单元格被占用\n              for (let rowspan = 1; rowspan < td.attrs.rowspan; rowspan++) {\n                for (let colspan = 0; colspan < (td.attrs.colspan || 1); colspan++) {\n                  map[(row + rowspan) + '.' + (col - colspan)] = 1\n                }\n              }\n            }\n            if (style) {\n              td.attrs.style = style\n            }\n            cells.push(td)\n            col++\n          }\n        }\n        if (row === 1) {\n          let temp = ''\n          for (let i = 1; i < col; i++) {\n            temp += (width[i] ? width[i] : 'auto') + ' '\n          }\n          styleObj['grid-template-columns'] = temp\n        }\n      }\n      node.children = cells\n    } else {\n      // 没有使用合并单元格的表格通过 table 布局实现\n      if ((node.c || editable)) {\n        styleObj.display = 'table'\n      }\n      if (!isNaN(spacing)) {\n        styleObj['border-spacing'] = spacing + 'px'\n      }\n      if (border || padding) {\n        // 遍历\n        (function traversal (nodes) {\n          for (let i = 0; i < nodes.length; i++) {\n            const td = nodes[i]\n            if (td.name === 'th' || td.name === 'td') {\n              if (border) {\n                td.attrs.style = `border:${border}px ${borderstyle || 'solid'} ${bordercolor || 'gray'};${td.attrs.style || ''}`\n              }\n              if (padding) {\n                td.attrs.style = `padding:${padding}px;${td.attrs.style || ''}`\n              }\n            } else if (td.children) {\n              traversal(td.children)\n            }\n          }\n        })(children)\n      }\n    }\n    // 给表格添加一个单独的横向滚动层\n    if (this.options.scrollTable && !(attrs.style || '').includes('inline')) {\n      const table = Object.assign({}, node)\n      node.name = 'div'\n      node.attrs = {\n        style: 'overflow:auto'\n      }\n      node.children = [table]\n      attrs = table.attrs\n    }\n  } else if ((node.name === 'td' || node.name === 'th') && (attrs.colspan || attrs.rowspan)) {\n    for (let i = this.stack.length; i--;) {\n      if (this.stack[i].name === 'table') {\n        this.stack[i].flag = 1 // 指示含有合并单元格\n        break\n      }\n    }\n  } else if (node.name === 'ruby') {\n    // 转换 ruby\n    node.name = 'span'\n    for (let i = 0; i < children.length - 1; i++) {\n      if (children[i].type === 'text' && children[i + 1].name === 'rt') {\n        children[i] = {\n          name: 'div',\n          attrs: {\n            style: 'display:inline-block;text-align:center'\n          },\n          children: [{\n            name: 'div',\n            attrs: {\n              style: 'font-size:50%;' + (children[i + 1].attrs.style || '')\n            },\n            children: children[i + 1].children\n          }, children[i]]\n        }\n        children.splice(i + 1, 1)\n      }\n    }\n  } else if (!editable && node.c ) {\n    (function traversal (node) {\n      node.c = 2\n      for (let i = node.children.length; i--;) {\n        const child = node.children[i]\n        // #ifdef (MP-WEIXIN || MP-QQ || APP-PLUS || MP-360) && VUE3\n        if (child.name && (config.inlineTags[child.name] || ((child.attrs.style || '').includes('inline') && child.children)) && !child.c) {\n          traversal(child)\n        }\n        // #endif\n        if (!child.c || child.name === 'table') {\n          node.c = 1\n        }\n      }\n    })(node)\n  }\n\n  if ((styleObj.display || '').includes('flex') && !(node.c || editable)) {\n    for (let i = children.length; i--;) {\n      const item = children[i]\n      if (item.f) {\n        item.attrs.style = (item.attrs.style || '') + item.f\n        item.f = undefined\n      }\n    }\n  }\n  // flex 布局时部分样式需要提取到 rich-text 外层\n  const flex = parent && ((parent.attrs.style || '').includes('flex') || (parent.attrs.style || '').includes('grid'))\n    // #ifdef MP-WEIXIN\n    // 检查基础库版本 virtualHost 是否可用\n    && !((node.c || editable) && wx.getNFCAdapter) // eslint-disable-line\n    // #endif\n    // #ifndef MP-WEIXIN || MP-QQ || MP-BAIDU || MP-TOUTIAO\n    && !node.c // eslint-disable-line\n  // #endif\n  if (flex) {\n    node.f = ';max-width:100%'\n  }\n\n  if (children.length >= 50 && (node.c || editable) && !(styleObj.display || '').includes('flex')) {\n    mergeNodes(children)\n  }\n  // #endif\n\n  for (const key in styleObj) {\n    if (styleObj[key]) {\n      const val = `;${key}:${styleObj[key].replace(' !important', '')}`\n      /* #ifndef APP-PLUS-NVUE */\n      if (flex && ((key.includes('flex') && key !== 'flex-direction') || key === 'align-self' || key.includes('grid') || styleObj[key][0] === '-' || (key.includes('width') && val.includes('%')))) {\n        node.f += val\n        if (key === 'width') {\n          attrs.style += ';width:100%'\n        }\n      } else /* #endif */ {\n        attrs.style += val\n      }\n    }\n  }\n  attrs.style = attrs.style.substr(1) || undefined\n  // #ifdef (MP-WEIXIN || MP-QQ) && VUE3\n  for (const key in attrs) {\n    if (!attrs[key]) {\n      delete attrs[key]\n    }\n  }\n  // #endif\n}\n\n/**\n * @description 解析到文本\n * @param {String} text 文本内容\n */\nParser.prototype.onText = function (text) {\n  if (!this.pre) {\n    // 合并空白符\n    let trim = ''\n    let flag\n    for (let i = 0, len = text.length; i < len; i++) {\n      if (!blankChar[text[i]]) {\n        trim += text[i]\n      } else {\n        if (trim[trim.length - 1] !== ' ') {\n          trim += ' '\n        }\n        if (text[i] === '\\n' && !flag) {\n          flag = true\n        }\n      }\n    }\n    // 去除含有换行符的空串\n    if (trim === ' ') {\n      if (flag) return\n      // #ifdef VUE3\n      else {\n        const parent = this.stack[this.stack.length - 1]\n        if (parent && parent.name[0] === 't') return\n      }\n      // #endif\n    }\n    text = trim\n  }\n  const node = Object.create(null)\n  node.type = 'text'\n  // #ifdef (MP-BAIDU || MP-ALIPAY || MP-TOUTIAO) && VUE3\n  node.attrs = {}\n  // #endif\n  node.text = decodeEntity(text)\n  if (this.hook(node)) {\n    // #ifdef MP-WEIXIN\n    if (this.options.selectable === 'force' && system.includes('iOS') && !uni.canIUse('rich-text.user-select')) {\n      this.expose()\n    }\n    // #endif\n    const siblings = this.stack.length ? this.stack[this.stack.length - 1].children : this.nodes\n    siblings.push(node)\n  }\n}\n\n/**\n * @description html 词法分析器\n * @param {Object} handler 高层处理器\n */\nfunction Lexer (handler) {\n  this.handler = handler\n}\n\n/**\n * @description 执行解析\n * @param {String} content 要解析的文本\n */\nLexer.prototype.parse = function (content) {\n  this.content = content || ''\n  this.i = 0 // 标记解析位置\n  this.start = 0 // 标记一个单词的开始位置\n  this.state = this.text // 当前状态\n  for (let len = this.content.length; this.i !== -1 && this.i < len;) {\n    this.state()\n  }\n}\n\n/**\n * @description 检查标签是否闭合\n * @param {String} method 如果闭合要进行的操作\n * @returns {Boolean} 是否闭合\n * @private\n */\nLexer.prototype.checkClose = function (method) {\n  const selfClose = this.content[this.i] === '/'\n  if (this.content[this.i] === '>' || (selfClose && this.content[this.i + 1] === '>')) {\n    if (method) {\n      this.handler[method](this.content.substring(this.start, this.i))\n    }\n    this.i += selfClose ? 2 : 1\n    this.start = this.i\n    this.handler.onOpenTag(selfClose)\n    if (this.handler.tagName === 'script') {\n      this.i = this.content.indexOf('</', this.i)\n      if (this.i !== -1) {\n        this.i += 2\n        this.start = this.i\n      }\n      this.state = this.endTag\n    } else {\n      this.state = this.text\n    }\n    return true\n  }\n  return false\n}\n\n/**\n * @description 文本状态\n * @private\n */\nLexer.prototype.text = function () {\n  this.i = this.content.indexOf('<', this.i) // 查找最近的标签\n  if (this.i === -1) {\n    // 没有标签了\n    if (this.start < this.content.length) {\n      this.handler.onText(this.content.substring(this.start, this.content.length))\n    }\n    return\n  }\n  const c = this.content[this.i + 1]\n  if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {\n    // 标签开头\n    if (this.start !== this.i) {\n      this.handler.onText(this.content.substring(this.start, this.i))\n    }\n    this.start = ++this.i\n    this.state = this.tagName\n  } else if (c === '/' || c === '!' || c === '?') {\n    if (this.start !== this.i) {\n      this.handler.onText(this.content.substring(this.start, this.i))\n    }\n    const next = this.content[this.i + 2]\n    if (c === '/' && ((next >= 'a' && next <= 'z') || (next >= 'A' && next <= 'Z'))) {\n      // 标签结尾\n      this.i += 2\n      this.start = this.i\n      this.state = this.endTag\n      return\n    }\n    // 处理注释\n    let end = '-->'\n    if (c !== '!' || this.content[this.i + 2] !== '-' || this.content[this.i + 3] !== '-') {\n      end = '>'\n    }\n    this.i = this.content.indexOf(end, this.i)\n    if (this.i !== -1) {\n      this.i += end.length\n      this.start = this.i\n    }\n  } else {\n    this.i++\n  }\n}\n\n/**\n * @description 标签名状态\n * @private\n */\nLexer.prototype.tagName = function () {\n  if (blankChar[this.content[this.i]]) {\n    // 解析到标签名\n    this.handler.onTagName(this.content.substring(this.start, this.i))\n    while (blankChar[this.content[++this.i]]);\n    if (this.i < this.content.length && !this.checkClose()) {\n      this.start = this.i\n      this.state = this.attrName\n    }\n  } else if (!this.checkClose('onTagName')) {\n    this.i++\n  }\n}\n\n/**\n * @description 属性名状态\n * @private\n */\nLexer.prototype.attrName = function () {\n  let c = this.content[this.i]\n  if (blankChar[c] || c === '=') {\n    // 解析到属性名\n    this.handler.onAttrName(this.content.substring(this.start, this.i))\n    let needVal = c === '='\n    const len = this.content.length\n    while (++this.i < len) {\n      c = this.content[this.i]\n      if (!blankChar[c]) {\n        if (this.checkClose()) return\n        if (needVal) {\n          // 等号后遇到第一个非空字符\n          this.start = this.i\n          this.state = this.attrVal\n          return\n        }\n        if (this.content[this.i] === '=') {\n          needVal = true\n        } else {\n          this.start = this.i\n          this.state = this.attrName\n          return\n        }\n      }\n    }\n  } else if (!this.checkClose('onAttrName')) {\n    this.i++\n  }\n}\n\n/**\n * @description 属性值状态\n * @private\n */\nLexer.prototype.attrVal = function () {\n  const c = this.content[this.i]\n  const len = this.content.length\n  if (c === '\"' || c === \"'\") {\n    // 有冒号的属性\n    this.start = ++this.i\n    this.i = this.content.indexOf(c, this.i)\n    if (this.i === -1) return\n    this.handler.onAttrVal(this.content.substring(this.start, this.i))\n  } else {\n    // 没有冒号的属性\n    for (; this.i < len; this.i++) {\n      if (blankChar[this.content[this.i]]) {\n        this.handler.onAttrVal(this.content.substring(this.start, this.i))\n        break\n      } else if (this.checkClose('onAttrVal')) return\n    }\n  }\n  while (blankChar[this.content[++this.i]]);\n  if (this.i < len && !this.checkClose()) {\n    this.start = this.i\n    this.state = this.attrName\n  }\n}\n\n/**\n * @description 结束标签状态\n * @returns {String} 结束的标签名\n * @private\n */\nLexer.prototype.endTag = function () {\n  const c = this.content[this.i]\n  if (blankChar[c] || c === '>' || c === '/') {\n    this.handler.onCloseTag(this.content.substring(this.start, this.i))\n    if (c !== '>') {\n      this.i = this.content.indexOf('>', this.i)\n      if (this.i === -1) return\n    }\n    this.start = ++this.i\n    this.state = this.text\n  } else {\n    this.i++\n  }\n}\n\nexport default Parser\n"],"names":["uni","style","node","wx"],"mappings":"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"}