{"version":3,"file":"personalInformationView.js","sources":["pages/setting/view/personalInformationView.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2V0dGluZy92aWV3L3BlcnNvbmFsSW5mb3JtYXRpb25WaWV3LnZ1ZQ"],"sourcesContent":["<template>\n\n  <view style=\"padding-top: 20vh; text-align: center; display: flex;justify-content: center;align-items: center;\">\n    <view>\n      <view class=\"avatar\" v-if=\"!store.getters.userInfo.avatar\">\n        <image src=\"/static/icon/camera.svg\"/>\n        <button open-type=\"chooseAvatar\" @chooseavatar=\"uploadAvatar\"\n                class=\"avatar-button\"\n                :plain=\"true\"></button>\n      </view>\n      <view class=\"user-avatar\" v-else>\n        <image :src=\"store.getters.userInfo.avatar\"/>\n        <button open-type=\"chooseAvatar\" @chooseavatar=\"uploadAvatar\"\n                class=\"avatar-button\"\n                :plain=\"true\"></button>\n      </view>\n    </view>\n  </view>\n  <view style=\"padding: 90rpx 160rpx 40rpx;\">\n    <input v-model=\"nickName\"\n           style=\"font-size: 35rpx; color: whitesmoke; border-bottom: 1rpx solid whitesmoke;text-align: center;padding-bottom: 20rpx\"\n           type=\"text\" placeholder=\"请设置昵称\" maxlength=\"8\"/>\n  </view>\n  <view style=\"position: fixed;z-index: 100;bottom: 0;left: 0;width: 100%\">\n    <view class=\"btn\" @click=\"onBlurNickName\">\n      修改昵称\n    </view>\n  </view>\n\n</template>\n\n<script setup>\n\nimport store from \"@/store\";\nimport env from \"@/env\";\nimport {getTokenValue} from \"@/store/token\";\nimport {reqUploadNickName} from \"@/api/user\";\nimport {onLoad} from '@dcloudio/uni-app'\nimport {ref} from 'vue'\n\nconst nickName = ref('')\n\nconst onBlurNickName = async (e) => {\n  if (nickName.value.length > 0) {\n    try {\n      uni.showLoading({\n        title: \"加载中\",\n      });\n      await reqUploadNickName({\n        nickName: nickName.value,\n      })\n      await store.dispatch('fetchUserInfo')\n      uni.showToast({\n        title: '修改成功',\n        icon: 'none',\n        duration: 4000\n      });\n    } catch (e) {\n      console.log(e)\n    } finally {\n      uni.hideLoading()\n    }\n\n\n  } else {\n    uni.showToast({\n      title: '用户昵称不能为空',\n      icon: 'none',\n      duration: 4000\n    });\n  }\n\n}\n\nconst uploadAvatar = (e) => {\n  uni.showLoading({\n    title: \"正在上传中\",\n  });\n  wx.uploadFile({\n    url: `${env.baseHttps}/user/upload/avatar`,  //服务器地址\n    filePath: e.detail.avatarUrl,\n    name: \"file\",\n    header: {\n      'Authorization': 'Bearer ' + getTokenValue()\n    },\n    async success(res) {\n      const data = JSON.parse(res.data);\n      if (data.code !== 200) {\n        uni.showToast({icon: 'none', duration: 3000, title: data.msg});\n        return\n      }\n      await store.dispatch('fetchUserInfo')\n      uni.showToast({\n        title: '上传头像成功',\n        icon: 'none',\n        duration: 2000\n      })\n    },\n    fail(res) {\n      uni.showToast({\n        title: '上传头像失败,请稍后重试',\n        icon: 'none',\n        duration: 2000\n      })\n    }\n  })\n}\n\nonLoad(() => {\n  nickName.value = store.getters.userInfo.nickName\n})\n\n</script>\n\n\n<style scoped lang=\"scss\">\n\n.user-avatar {\n  border-radius: 100%;\n  width: 150rpx;\n  height: 150rpx;\n  overflow: hidden;\n  position: relative;\n}\n\n.user-avatar image {\n  width: 100%;\n  height: 100%\n}\n\n.btn {\n  margin: 40rpx;\n  background: linear-gradient(120deg, rgb(250, 52, 54) 1%, rgb(186, 42, 107) 66.24%, rgb(184, 54, 189) 97.8%);;\n  animation: gradient 4s ease infinite;\n  background-size: 200% 200%;\n  padding: 30rpx;\n  border-radius: 20rpx;\n  color: white;\n\n  text-align: center;\n  font-size: 30rpx;\n\n}\n\n@keyframes gradient {\n  0% {\n    background-position: 0 12%;\n  }\n\n  50% {\n    background-position: 100% 100%;\n  }\n\n  100% {\n    background-position: 0 12%;\n  }\n}\n\n.avatar {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 100%;\n  width: 180rpx;\n  height: 180rpx;\n  background-color: #3e3e3e\n}\n\n.avatar image {\n  width: 70rpx;\n  height: 70rpx\n}\n\n.avatar > view {\n  border: 8rpx solid #000000;\n  border-radius: 100%;\n\n  width: 35rpx;\n  height: 35rpx;\n  position: absolute;\n  z-index: 2;\n  bottom: 0;\n  right: 0\n}\n\nbutton::after {\n  border: none;\n}\n\n.avatar-button {\n  width: 150rpx;\n  height: 150rpx;\n  position: absolute;\n  left: 0;\n  top: 0;\n  border: none;\n}\n</style>\n","import MiniProgramPage from 'E:/0/beifen/0/0Files/2025答辩/ts-ts/miniProgram/pages/setting/view/personalInformationView.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","reqUploadNickName","store","e","wx","env","getTokenValue","onLoad"],"mappings":";;;;;;;;;;AAwCA,UAAM,WAAWA,cAAG,IAAC,EAAE;AAEvB,UAAM,iBAAiB,OAAO,MAAM;AAClC,UAAI,SAAS,MAAM,SAAS,GAAG;AAC7B,YAAI;AACFC,wBAAAA,MAAI,YAAY;AAAA,YACd,OAAO;AAAA,UACf,CAAO;AACD,gBAAMC,2BAAkB;AAAA,YACtB,UAAU,SAAS;AAAA,UAC3B,CAAO;AACD,gBAAMC,YAAK,MAAC,SAAS,eAAe;AACpCF,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU;AAAA,UAClB,CAAO;AAAA,QACF,SAAQG,IAAG;AACVH,wBAAAA,MAAA,MAAA,OAAA,wDAAYG,EAAC;AAAA,QACnB,UAAc;AACRH,wBAAAA,MAAI,YAAa;AAAA,QAClB;AAAA,MAGL,OAAS;AACLA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QAChB,CAAK;AAAA,MACF;AAAA,IAEH;AAEA,UAAM,eAAe,CAAC,MAAM;AAC1BA,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,MACX,CAAG;AACDI,oBAAAA,KAAG,WAAW;AAAA,QACZ,KAAK,GAAGC,QAAI,SAAS;AAAA;AAAA,QACrB,UAAU,EAAE,OAAO;AAAA,QACnB,MAAM;AAAA,QACN,QAAQ;AAAA,UACN,iBAAiB,YAAYC,0BAAe;AAAA,QAC7C;AAAA,QACD,MAAM,QAAQ,KAAK;AACjB,gBAAM,OAAO,KAAK,MAAM,IAAI,IAAI;AAChC,cAAI,KAAK,SAAS,KAAK;AACrBN,0BAAAA,MAAI,UAAU,EAAC,MAAM,QAAQ,UAAU,KAAM,OAAO,KAAK,IAAG,CAAC;AAC7D;AAAA,UACD;AACD,gBAAME,YAAK,MAAC,SAAS,eAAe;AACpCF,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU;AAAA,UAClB,CAAO;AAAA,QACF;AAAA,QACD,KAAK,KAAK;AACRA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,YACN,UAAU;AAAA,UAClB,CAAO;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEAO,kBAAAA,OAAO,MAAM;AACX,eAAS,QAAQL,YAAAA,MAAM,QAAQ,SAAS;AAAA,IAC1C,CAAC;;;;;;;;;;;;;;;;;;;AC7GD,GAAG,WAAW,eAAe;"}