{"version":3,"file":"chatComponent.js","sources":["pages/dialogue/component/chatComponent.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovMC9iZWlmZW4vMC8wRmlsZXMvMjAyNeetlOi-qS90cy10cy9taW5pUHJvZ3JhbS9wYWdlcy9kaWFsb2d1ZS9jb21wb25lbnQvY2hhdENvbXBvbmVudC52dWU"],"sourcesContent":["<script setup>\nimport store from \"/store\";\nimport mpHtml from '/components/mp-html/components/mp-html/mp-html'\n\nimport {onLoad} from '@dcloudio/uni-app'\nimport {defineExpose, getCurrentInstance, reactive, ref} from 'vue'\nimport env from \"/env\";\nimport {getTokenValue, removeTokenValue} from \"/store/token\";\nimport {getChatTopic, setChatTopic} from \"/store/chatTopic\";\nimport FilePreviewComponent from \"./filePreviewComponent.vue\";\nimport AiLoadingComponent from \"./aiLoadingComponent.vue\";\nimport UploadChooseComponent from \"./uploadChooseComponent.vue\";\nimport InputComponent from \"./inputComponent.vue\";\n\n\nconst instance = getCurrentInstance();\nlet isDisplaying = false;\n\nconst messageQueue = reactive([]);\n\nconst messageList = ref([])\nconst isLoading = ref(false)\nconst inputRef = ref(null)\nconst uploadRef = ref(null)\nconst scrollTop = ref(0)\nconst wssAddress = ref(env.baseWss + '/chat/' + getTokenValue())\nconst file = ref(undefined)\n\n\nconst send = (text) => {\n  let files = file.value\n  if (!getTokenValue()) {\n    uni.reLaunch({\n      url: '/pages/user/user'\n    })\n    return\n  }\n\n  messageList.value.push({\n    issue: text,\n    answer: '',\n    isError: false,\n    file: files ? files : undefined\n  })\n  isLoading.value = true\n  file.value = undefined\n\n  inputRef.value.clear()\n  const index = messageList.value.length - 1;\n\n  setTimeout(() => {\n    scrollToBottom()\n  }, 100)\n\n  const conversionList = conversionDataFormat(index);\n  const sendMessagesData = compressArray(conversionList, 10000);\n\n  uni.connectSocket({\n    url: wssAddress.value\n  });\n\n\n  uni.onSocketOpen(function () {\n    uni.sendSocketMessage({\n      data: JSON.stringify({\n        messages: sendMessagesData,\n        model: store.getters.userSetting.model,\n        isFiltration: false\n      })\n    });\n  });\n\n  uni.onSocketMessage(function (res) {\n    messageQueue.push({\n      msg: res.data,\n      index: index,\n    });\n    displayMessages();\n  });\n\n  uni.onSocketError(function () {\n    uni.showToast({\n      icon: 'none',\n      duration: 1000,\n      title: '当前登录信息已过期,请重新登录'\n    });\n    removeTokenValue()\n    uni.reLaunch({\n      url: '/pages/user/user'\n    })\n  });\n\n  uni.onSocketClose(function () {\n    socketClose(index)\n  });\n}\n\n\nconst stop = () => {\n  messageQueue.value = []\n  uni.closeSocket({\n    success: function () {\n    },\n    fail: function (err) {\n\n    }\n  });\n\n}\n\nconst previewFileOrImage = (src) => {\n  // 定义常见的图片文件后缀\n  const imageExtensions = ['png', 'jpg', 'jpeg', 'gif', 'bmp', 'webp', 'svg', 'ico'];\n\n  // 从 URL 中提取文件名\n  let filename = src.split('/').pop().split('?')[0].split('#')[0]; // 处理查询参数和哈希\n\n  // 提取文件后缀\n  let extension = filename.split('.').pop().toLowerCase();\n\n  if (imageExtensions.includes(extension)) {\n    uni.previewImage({\n      urls: [src]\n    });\n    console.log(src)\n  } else {\n    uni.downloadFile({\n      url: src, // 文件网络地址\n      success: function (res) {\n        if (res.statusCode === 200) {\n          uni.openDocument({\n            filePath: res.tempFilePath, // 下载后的文件路径\n            success: function (openRes) {\n              console.log('文件打开成功');\n            }\n          });\n        }\n      }\n    });\n\n  }\n}\n\nconst socketClose = (index) => {\n  let interval = setInterval(() => {\n    let isError = false\n    if (messageQueue.length === 0) {\n      const answer = messageList.value[index].answer;\n      if (!answer) {\n        messageList.value.splice(index, 1)\n        isError = true\n      } else if (answer === \"é\") {\n        messageList.value[index].isError = true\n        messageList.value[index].answer = \"当前会话出现了点问题,请稍后重试\"\n      }\n      const chatTopic = getChatTopic();\n\n      if (!chatTopic.array[chatTopic.index].title && !isError) {\n        chatTopic.array[chatTopic.index].title = messageList.value[index].issue.substring(0, 20)\n      }\n      chatTopic.array[chatTopic.index].content = messageList.value\n      inputRef.value.clear()\n      isLoading.value = false\n      setChatTopic(chatTopic)\n      clearInterval(interval)\n    }\n  }, 50);\n}\n\nconst displayMessages = () => {\n\n  if (isDisplaying) {\n    return; // 如果正在显示消息，则直接返回，等待下一次调用\n  }\n  isDisplaying = true;\n  const message = messageQueue.shift(); // 取出队列中的第一个消息\n  if (message) {\n    let i = 0;\n    const {index, msg} = message;\n\n    // eslint-disable-next-line no-inner-declarations\n    function displayNextCharacter() {\n      const character = msg.charAt(i++);\n      if (character) {\n        messageList.value[index].answer += character;\n        if (i === msg.length) { // 只有在内容更新时才滚动到最底部\n          scrollToBottom()\n          setTimeout(displayNextCharacter, 20); //平滑控制更新频率\n        } else {\n          setTimeout(displayNextCharacter, 20);\n        }\n      } else {\n        isDisplaying = false; // 重置标志以便下次能够正确显示消息\n        displayMessages(); // 显示下一条消息\n      }\n    }\n\n    displayNextCharacter();\n  } else {\n    isDisplaying = false; // 重置标志以便下次能够正确显示消息\n  }\n}\n\nconst conversionDataFormat = (index) => {\n  const messages = []\n  messageList.value.forEach((c, itemIndex) => {\n    const {isError, issue, answer, file} = c\n    if (!isError) {\n      messages.push({\n        role: \"user\",\n        content: file ? issue + '[' + file.fileName + '](' + file.fileUrl + ')' : issue\n      })\n      if (itemIndex !== index) {\n        messages.push({\n          role: \"assistant\",\n          content: answer\n        })\n      }\n    }\n  })\n\n  return messages;\n}\n\nconst compressArray = (messages, threshold) => {\n  const totalLength = messages.reduce((acc, cur) => acc + cur.content.length, 0);\n  if (totalLength <= threshold) {\n    return messages;\n  }\n  const compressed = [];\n  for (let i = messages.length - 1; i >= 0; i--) {\n    const currentLength = messages[i].content.length;\n    if (currentLength <= threshold) {\n      compressed.push(messages[i]);\n      threshold -= currentLength;\n    } else {\n      compressed.push({\n        role: messages[i].role,\n        content: messages[i].content.substr(0, threshold),\n      });\n      break;\n    }\n  }\n\n  return compressed.reverse()\n}\n\nconst scrollToBottom = () => {\n  uni.createSelectorQuery().in(instance).select('#scroll-content').boundingClientRect((dom) => {\n    if (dom.height > 0) {\n      scrollTop.value = dom.height\n    }\n  }).exec()\n}\n\nconst showUpload = () => {\n  if (getTokenValue()) {\n    uploadRef.value.open()\n  } else {\n    uni.reLaunch({\n      url: '/pages/user/user',\n    })\n  }\n}\n\nconst chooseMessageFile = () => {\n  wx.chooseMessageFile({   // 只能选取微信聊天框中的文件\n    count: 1, // 最多选择一个文件\n    type: \"file\", // 选择文件类型\n    success: async function (res) {\n      const {name, size, path} = res.tempFiles[0];\n      await upload(path, name, size)\n    },\n  });\n}\n\nconst chooseSystemImage = () => {\n  uni.chooseImage({\n    count: 1, // 最多只能选择一张图片\n    success: async (res) => {\n\n      const {size, path} = res.tempFiles[0];\n      await upload(path, \"图片\", size)\n    }\n  });\n}\n\nconst upload = (path, name, size) => {\n  uni.showLoading({\n    title: \"正在上传中\",\n  });\n  wx.uploadFile({\n    url: `${env.baseHttps}/oss/upload/file`,  //服务器地址\n    filePath: path,     //文件临时路径\n    name: \"file\",\n    header: {\n      'Authorization': 'Bearer ' + getTokenValue(),\n      \"Content-Type\": \"multipart/form-data\",\n    },\n    success: (res) => {\n      const data = JSON.parse(res.data);\n      if (data.code !== 200) {\n        uni.showToast({icon: 'none', duration: 3000, title: data.msg});\n        return\n      }\n      const number = Math.round(parseInt(size) / 1024);\n      file.value = {\n        fileName: name,\n        fileSize: number,\n        fileUrl: data.data.fileUrl,\n        fileType: data.data.fileType\n      }\n      // 上传成功执行\n      uni.hideLoading();\n      uploadRef.value.close()\n    }\n  });\n}\n\nconst html = (data) => {\n  messageList.value = data\n}\n\nonLoad(() => {\n  setTimeout(() => {\n    scrollTop.value = 99999\n  }, 800)\n})\n\ndefineExpose(\n    {html}\n)\n\n</script>\n\n\n<template>\n  <view class=\"body\">\n    <view class=\"icon\" v-if=\"!(messageList.length>0)\">\n      <view>\n        <image src=\"/static/avatar/default_gpt.svg\"/>\n      </view>\n    </view>\n    <scroll-view scroll-y :scrollTop=\"scrollTop\" class=\"scroll\" v-else>\n      <view class=\"content\" id=\"scroll-content\">\n        <view v-for=\"(item,index) in messageList\" :key=\"index\">\n          <view class=\"slide-animation\" style=\"margin-bottom: 40rpx\">\n            <view class=\"user-chat \">\n              <view class=\"user-chat-background\">\n                <view>\n                  {{ item.issue }}\n                </view>\n              </view>\n              <image :src=\"\n              store.getters.userInfo\n    &&\n    store.getters.userInfo.avatar\n    ?\n    store.getters.userInfo.avatar\n    :\n    '/static/avatar/default_user.png'\n\"/>\n            </view>\n            <view class=\"chat-file slide-animation\" v-if=\"item.file\">\n              <file-preview-component\n                  @preview=\"previewFileOrImage\"\n                  :file-name=\"item.file.fileName\"\n                  :file-type=\"item.file.fileType\"\n                  :file-url=\"item.file.fileUrl\"\n                  :file-size=\"item.file.fileSize\"/>\n            </view>\n\n          </view>\n          <view class=\"ai-chat slide-animation\">\n            <view class=\"ai-avatar\">\n              <image src=\"/static/avatar/default_gpt.svg\"/>\n            </view>\n            <view class=\"ai-chat-container\">\n              <view class=\"ai-name\">\n                TYPE STARS\n              </view>\n              <view class=\"ai-chat-background\" v-if=\"item.answer\">\n                <view class=\"ai-content\">\n                  <mp-html :content=\"item.answer\" :selectable=\"true\" :lazy-load=\"true\" :copy-link=\"true\"\n                           :markdown=\"true\"/>\n                </view>\n              </view>\n              <view class=\"ai-loading\" v-else>\n                <ai-loading-component/>\n              </view>\n            </view>\n          </view>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n  <view v-if=\"file\" class=\" fixed-file slide-animation\">\n    <file-preview-component\n        :file-name=\"file.fileName\"\n        :file-type=\"file.fileType\"\n        :file-size=\"file.fileSize\"\n    />\n  </view>\n\n  <upload-choose-component ref=\"uploadRef\" @upload-file=\"chooseMessageFile\" @upload-image=\"chooseSystemImage\"/>\n\n  <input-component\n      ref=\"inputRef\"\n      @send=\"send\"\n      @stop=\"stop\"\n      @upload=\"showUpload\"\n      :is-prompt=\"!(messageList.length>0)\"\n      :is-loading=\"isLoading\"\n\n  />\n</template>\n\n\n<style scoped>\n.fixed-file {\n  position: fixed;\n  top: 82vh;\n  z-index: 999;\n  left: 20rpx;\n}\n\n.user-chat {\n  display: flex;\n  justify-content: flex-end;\n  color: black;\n\n}\n\n.chat-file {\n  display: flex;\n  justify-content: flex-end;\n  margin-right: 90rpx;\n  margin-top: 15rpx\n}\n\n\n.user-chat-background {\n  font-size: 26rpx;\n  max-width: 600rpx;\n  background-color: #27b561;\n  margin-right: 20rpx;\n  border-radius: 20rpx;\n\n}\n\n.user-chat-background view {\n  padding: 20rpx;\n  word-wrap: break-word;\n  color: black;\n}\n\n.user-chat image {\n  width: 70rpx;\n  height: 70rpx;\n  border-radius: 100%\n}\n\n.ai-chat {\n  display: flex;\n  justify-content: flex-start;\n  color: black;\n  margin-bottom: 80rpx\n}\n\n.ai-avatar {\n  margin-top: 8rpx;\n  width: 70rpx;\n  height: 70rpx;\n\n  border-radius: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center\n}\n\n.ai-avatar image {\n  width: 70rpx;\n  height: 70rpx\n}\n\n.ai-chat-container {\n  margin-left: 20rpx;\n}\n\n.ai-name {\n  font-weight: 550;\n  margin-bottom: 10rpx;\n  font-size: 23rpx;\n  color: #5f5f5f\n}\n\n.ai-chat-background {\n  font-size: 26rpx;\n  max-width: 600rpx;\n  background-color: rgb(40, 40, 40);\n  border-radius: 20rpx;\n  color: white\n}\n\n.ai-content {\n  word-wrap: break-word;\n  padding: 0 20rpx\n}\n\n.ai-loading {\n\n  padding: 0 20rpx;\n  background-color: rgb(40, 40, 40);\n\n  border-radius: 20rpx;\n\n}\n\n.scroll {\n  height: 78vh\n}\n\n.content {\n  padding-bottom: 30rpx\n\n}\n\n.slide-animation {\n  animation: slideEase 0.5s ease-in-out forwards;\n}\n\n@keyframes slideEase {\n  0% {\n    transform: translateX(-100px);\n  }\n  100% {\n    transform: translateX(0);\n  }\n}\n\n.icon {\n  padding-top: 35vh;\n  animation: fadeIn 0.5s ease-in-out forwards;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n}\n\n.icon > view {\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 75rpx;\n  height: 75rpx;\n\n  border-radius: 100%\n}\n\n.icon image {\n  width: 75rpx;\n  height: 75rpx;\n}\n</style>\n","import Component from 'E:/0/beifen/0/0Files/2025答辩/ts-ts/miniProgram/pages/dialogue/component/chatComponent.vue'\nwx.createComponent(Component)"],"names":["getCurrentInstance","reactive","ref","env","getTokenValue","uni","store","removeTokenValue","getChatTopic","setChatTopic","file","wx","onLoad"],"mappings":"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"}